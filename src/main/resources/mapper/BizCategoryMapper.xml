<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tarzan.module.admin.mapper.BizCategoryMapper">
	<select id="selectCategories" parameterType="com.tarzan.module.admin.model.BizCategory" resultType="com.tarzan.module.admin.model.BizCategory" >
		select t.*,
		p.id p_id,
		p.`pid` p_pid,
		p.`name` p_name,
		p.description p_description,
		p.`status` p_status,
		p.icon p_icon,
		n.`id` n_id,
		n.`pid` n_pid,
		n.`name` n_name,
		n.description n_description,
		n.`status` n_status,
		n.icon n_icon
		FROM
		biz_category t
		LEFT JOIN biz_category p ON t.pid = p.id
		LEFT JOIN biz_category n ON n.pid = t.id
		WHERE 1=1
		<if test="name !=null and name != ''">
			AND t.`name` like concat('%', #{name}, '%')
		</if>
		<if test="description !=null and description != ''">
			AND t.description like concat('%', #{description}, '%')
		</if>
		<if test="status !=null">
			AND t.`status` = #{status}
		</if>
		<if test="pid !=null">
			AND t.pid = #{pid}
		</if>
		ORDER BY t.sort ASC
	</select>

	<select id="getById" parameterType="int" resultType="com.tarzan.module.admin.model.BizCategory">
		select a.*,
		p.pid p_pid,
		p.`name` p_name,
		p.description p_description
		from biz_category a
		LEFT JOIN biz_category p ON a.pid = p.id
		WHERE a.id=#{id}
	</select>
</mapper>

